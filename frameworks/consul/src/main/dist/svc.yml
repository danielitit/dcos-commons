name: {{FRAMEWORK_NAME}}
scheduler:
  principal: {{FRAMEWORK_PRINCIPAL}}
  user: {{FRAMEWORK_USER}}
pods:
  consul-server:
    count: 3
    placement: '{{{NODE_PLACEMENT}}}'
    {{#ENABLE_VIRTUAL_NETWORK}}
    networks:
      {{VIRTUAL_NETWORK_NAME}}:
        labels: {{VIRTUAL_NETWORK_PLUGIN_LABELS}}
    {{/ENABLE_VIRTUAL_NETWORK}}
    tasks:
      server:
        goal: RUNNING
        cmd: "consul agent -server -bootstrap-expect={{BOOTSTRAP_NODE_COUNT}}"
        cpus: {{NODE_CPUS}}
        memory: {{NODE_MEM}}
        env:
          CONSUL_LOCAL_CONFIG={{CONSUL_LOCAL_CONFIG}}
  consul-agent:
    count: 3
    placement: '{{NODE_PLACEMENT}}'
    networks:
      {{VIRTUAL_NETWORK_NAME}}
        labels: {{VIRTUAL_NETWORK_PLUGIN_LABELS}}
    {{/ENABLE_VIRTUAL_NETWORK}}
    tasks:
      server:
        goal: RUNNING
        cmd: "consul agent -retry-join=consul-server-0-server.consul.autoip.dcos.thisdcos.directory
        cpus: {{NODE_CPUS}}
        memory: {{NODE_MEM}}
        env:
          CONSUL_LOCAL_CONFIG={{CONSUL_LOCAL_CONFIG}}